/*! nicole - v1.0.0 - 2015-02-19
* Copyright (c) 2015 Sven Koelpin; Licensed MIT */
!function(a,b){"use strict";a.Nicole=function(){var d={},e={},f=!1,g=function(a,b){if("string"!=typeof a||"function"!=typeof b)throw new Error("module-name and module-function must be defined!");if(d[a])throw new Error("module "+a+" declared multiple times");d[a]=b},h=function(c){c||(c=b);for(var d=c.querySelectorAll("input[data-modulename]"),e=0,g=d.length;g>e;e++){var j=d[e].getAttribute("id");-1!==j.indexOf("nicole",j.length-6)&&i(d[e])}a.jsf&&!f&&(a.jsf.ajax.addOnEvent(function(a){if("success"===a.status)for(var c=a.responseXML.getElementsByTagName("update"),d=0,e=c.length;e>d;d++)h(b.getElementById(c[d].getAttribute("id")))}),f=!0)},i=function(a){var b=j(a,"modulename");e[b]||(e[b]=0),e[b]+=1;var f=j(a,"instanceid"),g=d[b];if(!g)throw new Error("There is no js-module for the declared module '"+b+"'");var h={};if(a.dataset)for(var i in a.dataset)a.dataset.hasOwnProperty(i)&&"modulename"!==i&&(h[i]=a.dataset[i]);else for(var k in a.attributes)a.attributes.hasOwnProperty(k)&&"data-modulename"!==a.attributes[k].name&&(h[a.attributes[k].name.substr(5).toLowerCase()]=a.attributes[k].value);var l=c.create(h);l.instanceId=f||b+"_"+e[b],g.call(l)},j=function(a,b){return a.dataset?a.dataset[b]:a.getAttribute("data-"+b)};return{start:h,module:g}}(),a.Nicole.events={};var c=function(){var c=function(b){if(a.$)return a.$("#"+j.call(this,b).replace(/:/g,"\\:"));throw new Error("jquery required")},d=function(a){return a.replace(/:/g,"\\:")},e=function(a){return b.getElementById(j.call(this,a))},f=function(a,b){if("undefined"!=typeof a&&"string"==typeof a&&(a=a.toLowerCase(),"undefined"!=typeof this._params[a])){if(b){if("int"===b)return parseInt(this._params[a],10);if("float"===b)return parseFloat(this._params[a]);if("bool"===b)return"true"===this._params[a]}return this._params[a]}throw new Error("param "+a+" is not defined")},g=function(a){return this.parameter(a).length>0},h=function(b,c){var d=i.call(this,c.execute),e=i.call(this,c.render);a.jsf.ajax.request(this.elm(b),null,{execute:d,render:e,onevent:function(a){"begin"===a.status&&c.begin&&"function"==typeof c.begin&&c.begin.call(null,a),"complete"===a.status&&c.complete&&"function"==typeof c.complete&&c.complete.call(null,a),"success"===a.status&&c.success&&"function"==typeof c.success&&c.success.call(null,a)}})},i=function(a){var b="@none";return a&&a instanceof Array?(b="",a.forEach(function(a){"string"==typeof a&&(b=b+" "+this.clientId(a))}.bind(this))):"string"==typeof a&&(b=a),b},j=function(a){return 0===this._clientid.length?a:this._clientid+":"+a},k=function(b,c){a.Nicole.events[b]&&(c||(c={}),c.src=this.instanceId,a.Nicole.events[b].forEach(function(a){a.src&&a.src!==c.src||a.callBack(c)}))},l=function(b,c,d){a.Nicole.events[b]||(a.Nicole.events[b]=[]),a.Nicole.events[b].push({callBack:c,src:d})};return{create:function(a){var b=a.clientid;return(!b||b.length<1)&&(b=""),{_clientid:b,_params:a,elm:e,$elm:c,clientId:j,ajax:h,parameter:f,parameterHasValue:g,escapeId:d,subscribe:l,emit:k}}}}();a.$?a.$(b).ready(function(){a.Nicole.start()}):b.addEventListener("DOMContentLoaded",function(){a.Nicole.start()})}(window,window.document);